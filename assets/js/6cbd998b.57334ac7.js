"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[4072],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>d});var r=s(6540);const i={},o=r.createContext(i);function t(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(o.Provider,{value:n},e.children)}},9166:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"MERN - Fullstack/Od ExpressJS do ExpressTS","title":"Od ExpressJS do ExpressTS","description":"- Webstorm:","source":"@site/docs/5. MERN - Fullstack/1. Od ExpressJS do ExpressTS.mdx","sourceDirName":"5. MERN - Fullstack","slug":"/MERN - Fullstack/Od ExpressJS do ExpressTS","permalink":"/web/docs/MERN - Fullstack/Od ExpressJS do ExpressTS","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/5. MERN - Fullstack/1. Od ExpressJS do ExpressTS.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Od ExpressJS do ExpressTS"},"sidebar":"tutorialSidebar","previous":{"title":"Wprowadzenie do MERN","permalink":"/web/docs/MERN - Fullstack/Intro MERN"},"next":{"title":"Po\u0142\u0105czenie MongoDB-ExpressTS","permalink":"/web/docs/MERN - Fullstack/Pod\u0142\u0105czenie do MongoDB"}}');var i=s(4848),o=s(8453);const t={title:"Od ExpressJS do ExpressTS"},d="Tworzymy projekst Express w WebStorm",l={},a=[{value:"Importy",id:"importy",level:2},{value:"ExpressJS",id:"expressjs",level:3},{value:"CORS (Cross-Origin Resource Sharing)",id:"cors-cross-origin-resource-sharing",level:3},{value:"Modu\u0142 <code>path</code>",id:"modu\u0142-path",level:3},{value:"<code>dotenv</code> \u2013 Obs\u0142uga zmiennych \u015brodowiskowych",id:"dotenv--obs\u0142uga-zmiennych-\u015brodowiskowych",level:3},{value:"Przekszta\u0142camy zawarto\u015b\u0107 pliku <code>app.ts</code> :",id:"przekszta\u0142camy-zawarto\u015b\u0107-pliku-appts-",level:2},{value:"Importy",id:"importy-1",level:2},{value:"<code>debug</code>  - biblioteka do logowania komunikat\xf3w",id:"debug----biblioteka-do-logowania-komunikat\xf3w",level:3}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"tworzymy-projekst-express-w-webstorm",children:"Tworzymy projekst Express w WebStorm"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Webstorm:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["projekt Express:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"bez View Engine,"}),"\n",(0,i.jsx)(n.li,{children:"z Stylesheet ustawionym na Plain CSS"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["utw\xf3rz folder ",(0,i.jsx)(n.code,{children:"src"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["utw\xf3rz w nim folder ",(0,i.jsx)(n.code,{children:"models"})]}),"\n",(0,i.jsxs)(n.li,{children:["do folderu ",(0,i.jsx)(n.code,{children:"src"})," przenie\u015b folder ",(0,i.jsx)(n.code,{children:"routes"})]}),"\n",(0,i.jsxs)(n.li,{children:["do folderu ",(0,i.jsx)(n.code,{children:"src"})," przenie\u015b plik ",(0,i.jsx)(n.code,{children:"app.js"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"zainstaluj podstawowe pakiety potrzebne dla TypeScript:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"npm install --save-dev typescript ts-node @types/node @types/express nodemon"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["zr\xf3b plik dla TypeScript ",(0,i.jsx)(n.code,{children:"npx tsc --init"})," i wprowad\u017a zmiany:"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'{\n  "compilerOptions": {\n\n    /* Language and Environment */\n    "target": "es2016",                                  /* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */\n\n    /* Modules */\n    "module": "commonjs",                                /* Specify what module code is generated. */\n    "rootDir": "./src",                                  /* Specify the root folder within your source files. */\n.\n    ...                         .\n     "outDir": "./dist",                                   /* Specify an output folder for all emitted files. */\n\n    "esModuleInterop": true,                             /* Emit additional JavaScript to ease support for importing CommonJS modules. This enables \'allowSyntheticDefaultImports\' for type compatibility. */\n\n    "forceConsistentCasingInFileNames": true,            /* Ensure that casing is correct in imports. */\n\n    /* Type Checking */\n    "strict": true,                                      /* Enable all strict type-checking options. */\n\n    /* Completeness */\n\n    "skipLibCheck": true                                 /* Skip type checking all .d.ts files. */\n  }\n}\n\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["zmie\u0144 rozszerzenie ",(0,i.jsx)(n.code,{children:"/bin/www.js"})," na ",(0,i.jsx)(n.code,{children:"/bin/www.ts"})," pisz\u0105c w terminalu instrukcj\u0119 ",(0,i.jsx)(n.code,{children:"mv bin/www bin/www.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:["w g\xf3wnej \u015bcie\u017cce zr\xf3b plik ",(0,i.jsx)(n.code,{children:".env"})," z zawarto\u015bci\u0105:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dotenv",children:"MONGO_URI=mongodb://localhost:27017/mydatabase\nPORT=5000\n"})}),"\n",(0,i.jsx)(n.p,{children:"STRUKTURA PROJEKTU POWINNA WYGL\u0104DA\u0106 TAK:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"<twojaNazwaProjektu>\n    |- .idea\n    |- bin\n        |-- www.ts\n    |- node_modules\n    |- public\n    |- src\n        |--  models\n        |--  routes\n        |--  app.ts\n    |- .env\n    |- package.json\n    |- package-lock.json\n    |- tsconfig.json\n"})}),"\n",(0,i.jsxs)(n.h1,{id:"konfiguracja-express-w-appjs",children:["Konfiguracja Express w ",(0,i.jsx)(n.code,{children:"app.js"})]}),"\n",(0,i.jsx)(n.h2,{id:"importy",children:"Importy"}),"\n",(0,i.jsx)(n.h3,{id:"expressjs",children:"ExpressJS"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"to framework dla Node.js, kt\xf3ry u\u0142atwia budow\u0119 backendu \u2013"}),"\n",(0,i.jsxs)(n.li,{children:["obs\u0142uguje","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"trasy,"}),"\n",(0,i.jsx)(n.li,{children:"middleware,"}),"\n",(0,i.jsx)(n.li,{children:"requesty"}),"\n",(0,i.jsx)(n.li,{children:"responsy."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)("span",{style:{color:"#ff7339"},children:(0,i.jsx)(n.p,{children:"Nie musisz instalowa\u0107, ale brakuje obs\u0142ugi typ\xf3w, wi\u0119c doinstaluj typy:"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"npm install @types/express --save-dev"})}),"\n",(0,i.jsx)(n.h3,{id:"cors-cross-origin-resource-sharing",children:"CORS (Cross-Origin Resource Sharing)"}),"\n",(0,i.jsx)(n.p,{children:"CORS pozwala na wysy\u0142anie \u017c\u0105da\u0144 mi\u0119dzy r\xf3\u017cnymi domenami - np:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["frontend na ",(0,i.jsx)(n.code,{children:"http://localhost:3000"})," chce po\u0142\u0105czy\u0107 si\u0119 z"]}),"\n",(0,i.jsxs)(n.li,{children:["backendem na  ",(0,i.jsx)(n.code,{children:"http://localhost:5000"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Bez CORS przegl\u0105darka nie pozwoli na komunikacj\u0119 mi\u0119dzy backendem a frontendem."}),"\n",(0,i.jsxs)(n.p,{children:["INSTALACJA\n",(0,i.jsx)(n.code,{children:"npm install cors"}),"\n",(0,i.jsx)(n.code,{children:"npm install @types/cors --save-dev  # Typy dla TS"})]}),"\n",(0,i.jsxs)(n.h3,{id:"modu\u0142-path",children:["Modu\u0142 ",(0,i.jsx)(n.code,{children:"path"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"modu\u0142 path to wbudowana biblioteka Node.js do pracy z systemowymi \u015bcie\u017ckami plik\xf3w."}),"\n",(0,i.jsx)(n.li,{children:"przyk\u0142adowe u\u017cycie"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import path from "path";\napp.use(express.static(path.join(__dirname, "../public")));\n'})}),"\n",(0,i.jsx)(n.p,{children:"czyli pliki statyczne w Express b\u0119d\u0105 dost\u0119pne w folderze public"}),"\n",(0,i.jsxs)(n.h3,{id:"dotenv--obs\u0142uga-zmiennych-\u015brodowiskowych",children:[(0,i.jsx)(n.code,{children:"dotenv"})," \u2013 Obs\u0142uga zmiennych \u015brodowiskowych"]}),"\n",(0,i.jsx)(n.p,{children:"Pozwala przechowywa\u0107 wra\u017cliwe dane (np. has\u0142a do bazy, klucze API) w pliku .env, zamiast trzyma\u0107 je w kodzie."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"instalacja"}),": ",(0,i.jsx)(n.code,{children:"npm install dotenv"}),"\n",(0,i.jsx)(n.em,{children:"instalacja typ\xf3w"}),": ",(0,i.jsx)(n.code,{children:"npm install @types/dotenv --save-dev"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"przyk\u0142adowe u\u017cycie"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import dotenv from "dotenv";\ndotenv.config(); // Za\u0142aduj zmienne z `.env`\n\nconst port = process.env.PORT || 3000; // Pobiera warto\u015b\u0107 z .env\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"przekszta\u0142camy-zawarto\u015b\u0107-pliku-appts-",children:["Przekszta\u0142camy zawarto\u015b\u0107 pliku ",(0,i.jsx)(n.code,{children:"app.ts"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import express from "express";\nimport cors from "cors";\nimport path from "path";\nimport dotenv from "dotenv";\n\n\ndotenv.config();\n\n\nconst app = express();\n\napp.use(cors());\napp.use(express.json()); // Parsowanie JSON w requestach\n\n\napp.use(express.static(path.join(__dirname, "../public")));\n\n\napp.get("/", (req, res) => {\n  res.json({ message: "API Express + TypeScript dzia\u0142a!" });\n});\n\nexport default app;\n'})}),"\n",(0,i.jsxs)(n.h1,{id:"zmiany-w-pliku-startowym-binwwwts",children:["Zmiany w pliku startowym ",(0,i.jsx)(n.code,{children:"/bin/www.ts"})]}),"\n",(0,i.jsx)(n.h2,{id:"importy-1",children:"Importy"}),"\n",(0,i.jsxs)(n.h3,{id:"debug----biblioteka-do-logowania-komunikat\xf3w",children:[(0,i.jsx)(n.code,{children:"debug"}),"  - biblioteka do logowania komunikat\xf3w"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"umo\u017cliwia logowanie komunikat\xf3w w trakcie dzia\u0142ania aplikacji."}),"\n",(0,i.jsxs)(n.li,{children:["jest l\u017cejsza ni\u017c ",(0,i.jsx)(n.code,{children:"console.log( )"}),", bo nie loguje nic, je\u015bli nie ustawisz zmiennej ",(0,i.jsx)(n.code,{children:"DEBUG"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["jest cz\u0119sto u\u017cywana w Express, m.in. w pliku bin/",(0,i.jsx)(n.a,{href:"http://www.ts",children:"www.ts"}),".","\n",(0,i.jsx)(n.strong,{children:"instalacja"}),": ",(0,i.jsx)(n.code,{children:"npm install debug"}),"\n",(0,i.jsx)(n.strong,{children:"instalacja"})," typ\xf3w: ",(0,i.jsx)(n.code,{children:"npm install @types/debug --save-dev"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Logger"})," to narz\u0119dzie do rejestrowania (logowania) informacji o dzia\u0142aniu aplikacji.\nZamiast u\u017cywa\u0107 zwyk\u0142ego ",(0,i.jsx)(n.code,{children:"console.log()"}),", mo\u017cemy korzysta\u0107 z dedykowanego loggera, kt\xf3ry:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"organizuje logi w aplikacji"}),"\n",(0,i.jsx)(n.li,{children:"pozwala filtrowa\u0107 logi wed\u0142ug kategorii"}),"\n",(0,i.jsxs)(n.li,{children:["nie obci\u0105\u017ca aplikacji, je\u015bli debugowanie jest wy\u0142\u0105czone\n",(0,i.jsx)(n.code,{children:'const debugLog = debug("express-ts-mongodb:server"); // Tworzy instancj\u0119 loggera'})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"express-ts-mongodb:server "})," to ",(0,i.jsx)(n.em,{children:"namespace"})," (przestrze\u0144 nazw) loggera.\nDzi\u0119ki temu mo\u017cemy w\u0142\u0105czy\u0107 logowanie tylko dla konkretnej cz\u0119\u015bci aplikacji."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"#!/usr/bin/env node\n\n/**\n * Module dependencies.\n */\n\nimport  app from '../src/app';\nimport debug from 'debug';\nimport http from 'http';\n\n/**\n * Get port from environment and store in Express.\n */\n\nconst port = normalizePort(process.env.PORT || '3000');\napp.set('port', port);\n\nconst debugLog = debug(\"express-ts-mongodb:server\"); // Tworzy instancj\u0119 loggera\n\n/**\n * Create HTTP server.\n */\n\nconst server = http.createServer(app);\n\n/**\n * Listen on provided port, on all network interfaces.\n */\n\nserver.listen(port);\nserver.on('error', onError);\nserver.on('listening', onListening);\n\n/**\n * Normalize a port into a number, string, or false.\n */\n\nfunction normalizePort(val: string): number | string | false {\n  const port = parseInt(val, 10);\n\n  if (isNaN(port)) {\n    // named pipe\n    return val;\n  }\n\n  if (port >= 0) {\n    // port number\n    return port;\n  }\n\n  return false;\n}\n\n/**\n * Event listener for HTTP server \"error\" event.\n */\n\nfunction onError(error: NodeJS.ErrnoException) {\n  if (error.syscall !== 'listen') {\n    throw error;\n  }\n\n  const bind = typeof port === 'string'\n    ? 'Pipe ' + port\n    : 'Port ' + port;\n\n  // handle specific listen errors with friendly messages\n  switch (error.code) {\n    case 'EACCES':\n      console.error(bind + ' requires elevated privileges');\n      process.exit(1);\n      break;\n    case 'EADDRINUSE':\n      console.error(bind + ' is already in use');\n      process.exit(1);\n      break;\n    default:\n      throw error;\n  }\n}\n\n/**\n * Event listener for HTTP server \"listening\" event.\n */\n\nfunction onListening() {\n  const addr = server.address();\n  const bind = typeof addr === 'string'\n    ? 'pipe ' + addr\n    : 'port ' + addr?.port;\n  debug('Listening on ' + bind);\n}\n\n"})}),"\n",(0,i.jsxs)(n.h1,{id:"konfiguracja-packagejson",children:["Konfiguracja ",(0,i.jsx)(n.code,{children:"package.json"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'"scripts": {\n  "start": "node dist/bin/www.js",\n  "dev": "ts-node bin/www.ts",\n  "build": "tsc"\n},\n'})}),"\n",(0,i.jsxs)(n.p,{children:["wszystko dzia\u0142a opr\xf3cz ",(0,i.jsx)(n.code,{children:"npm run build"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"error TS6059: File '/home/js/WebstormProjects/express-ts-mongodb/bin/www.ts' is not under 'rootDir' '/home/js/WebstormProjects/express-ts-mongodb/src'. 'rootDir' is expected to contain all source files.\n  The file is in the program because:\n    Matched by default include pattern '**/*'\n"})}),"\n",(0,i.jsxs)(n.p,{children:["TypeScript zak\u0142ada, \u017ce wszystkie \u017ar\xf3d\u0142a musz\u0105 by\u0107 w ",(0,i.jsx)(n.code,{children:"rootDir"}),", a ",(0,i.jsx)(n.code,{children:"bin/www.ts"})," le\u017cy poza nim (",(0,i.jsx)(n.code,{children:"src"}),"), st\u0105d b\u0142\u0105d.\nPrzeniesiemy folder bin do src/bin\nteraz package.json"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'"scripts": {\n  "start": "node dist/bin/www.js",\n  "dev": "ts-node src/bin/www.ts",\n  "build": "tsc"\n},\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);