"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5482],{5587:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"Node/Modu\u0142y/Modul_FS","title":"Modu\u0142 fs - File System","description":"Definicja","source":"@site/docs/2. Node/3.Modu\u0142y/10.Modul_FS.mdx","sourceDirName":"2. Node/3.Modu\u0142y","slug":"/Node/Modu\u0142y/Modul_FS","permalink":"/web/docs/Node/Modu\u0142y/Modul_FS","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/2. Node/3.Modu\u0142y/10.Modul_FS.mdx","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Modu\u0142 fs - File System"},"sidebar":"tutorialSidebar","previous":{"title":"Aplikacja sklepik z JSON","permalink":"/web/docs/Node/Modu\u0142y/AplikacjaSklepikZJSON"},"next":{"title":"Modu\u0142 `path`","permalink":"/web/docs/Node/Modu\u0142y/Modul_PATH"}}');var o=i(4848),l=i(8453);const r={title:"Modu\u0142 fs - File System"},d="Modu\u0142 fs",c={},a=[{value:"Definicja",id:"definicja",level:2},{value:"Przygotowanie projektu",id:"przygotowanie-projektu",level:2},{value:"Odczyt i zapis (nadpisywanie) do pliku",id:"odczyt-i-zapis-nadpisywanie-do-pliku",level:2},{value:"Dzia\u0142ania synchroniczne",id:"dzia\u0142ania-synchroniczne",level:3},{value:"Zapis do pliku",id:"zapis-do-pliku",level:4},{value:"Odczyt z pliku",id:"odczyt-z-pliku",level:4},{value:"Dzia\u0142ania asynchroniczne",id:"dzia\u0142ania-asynchroniczne",level:3},{value:"Zapis z callbackiem",id:"zapis-z-callbackiem",level:4},{value:"Zapis z <code>Promisem</code>",id:"zapis-z-promisem",level:4},{value:"Do\u0142\u0105czanie danych do pliku - <code>fs.appendFile()</code>",id:"do\u0142\u0105czanie-danych-do-pliku---fsappendfile",level:2},{value:"Wersja z callbackiem",id:"wersja-z-callbackiem",level:3},{value:"Wersja z Promisem",id:"wersja-z-promisem",level:3},{value:"Usuwanie pliku - <code>unlink</code>",id:"usuwanie-pliku---unlink",level:2},{value:"Usuwanie - spos\xf3b podstawowy",id:"usuwanie---spos\xf3b-podstawowy",level:3},{value:"Usuwanie - &quot;\u0142adny&quot; spos\xf3b",id:"usuwanie---\u0142adny-spos\xf3b",level:3},{value:"Foldery",id:"foldery",level:2},{value:"Tworzenie folderu",id:"tworzenie-folderu",level:3},{value:"Usuwanie folderu",id:"usuwanie-folderu",level:3},{value:"Listowanie plik\xf3\u0153 z folderu",id:"listowanie-plik\xf3\u0153-z-folderu",level:3}];function t(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsxs)(n.h1,{id:"modu\u0142-fs",children:["Modu\u0142 ",(0,o.jsx)(n.code,{children:"fs"})]})}),"\n",(0,o.jsx)(n.h2,{id:"definicja",children:"Definicja"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"fs"})," (",(0,o.jsx)(n.em,{children:"file system"}),") pozwala na operacje na plikach i katalogach."]}),"\n",(0,o.jsxs)(n.li,{children:["Istniej\u0105 dwie wersje wi\u0119kszo\u015bci metod:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["synchroniczne (",(0,o.jsx)(n.code,{children:"readFileSync"}),", ",(0,o.jsx)(n.code,{children:"writeFileSync"}),") - one blokuj\u0105 program,"]}),"\n",(0,o.jsxs)(n.li,{children:["asynchroniczne (",(0,o.jsx)(n.code,{children:"readFile"}),", ",(0,o.jsx)(n.code,{children:"writeFile"}),") - one korzystaj\u0105 z ",(0,o.jsx)(n.code,{children:"callback\xf3w"})," / ",(0,o.jsx)(n.code,{children:"Promise"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"przygotowanie-projektu",children:"Przygotowanie projektu"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["utw\xf3rz nowy projekt TS (",(0,o.jsx)(n.code,{children:"New"})," -> ",(0,o.jsx)(n.code,{children:"New Project"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:["doinstaluj zale\u017cno\u015bci ",(0,o.jsx)(n.code,{children:"npm i"})]}),"\n",(0,o.jsxs)(n.li,{children:["dopiszmy do ",(0,o.jsx)(n.code,{children:"package.json"})," instrukcje ",(0,o.jsx)(n.code,{children:"start"})," i ",(0,o.jsx)(n.code,{children:"dev"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:' "scripts": {\n    "build": "tsc",\n    "start": "npm run build && node dist/index.js",\n    "dev": "ts-node src/index.ts"\n  },\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"sprawd\u017a dzia\u0142anie programu przez:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"npm run dev"})}),"\n",(0,o.jsxs)(n.li,{children:["potem ",(0,o.jsx)(n.code,{children:"npm run start"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["jak pod koniec poprzedniej lekcji wspominali\u015bmy, musimy doinstalowa\u0107 typy\n",(0,o.jsx)(n.code,{children:"npm install --save-dev @types/node"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"odczyt-i-zapis-nadpisywanie-do-pliku",children:"Odczyt i zapis (nadpisywanie) do pliku"}),"\n",(0,o.jsx)(n.h3,{id:"dzia\u0142ania-synchroniczne",children:"Dzia\u0142ania synchroniczne"}),"\n",(0,o.jsx)(n.h4,{id:"zapis-do-pliku",children:"Zapis do pliku"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["w pliku ",(0,o.jsx)(n.code,{children:"index.ts"})," dopiszemy:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import fs from "fs"\n\nconsole.log("Start")\n\n//plik nieistniej\u0105cy zostanie utworzony\nfs.writeFileSync("test.txt", "Hello World")\nconsole.log("zapisano 1")\n\n// zawarto\u015b\u0107 pliku zostanie nadpisana\nfs.writeFileSync("test.txt", "Witaj \u015bwiecie")\nconsole.log("zapisano 2")\n\nconsole.log("End 1")\n\n'})}),"\n",(0,o.jsx)(n.h4,{id:"odczyt-z-pliku",children:"Odczyt z pliku"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["w pliku ",(0,o.jsx)(n.code,{children:"index.ts"})," dopiszemy:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'// odczyt z pliku\nconst content = fs.readFileSync("test.txt", "utf-8")\nconsole.log(content)\n\nconsole.log("End 2")\n\n\n'})}),"\n",(0,o.jsx)(n.h3,{id:"dzia\u0142ania-asynchroniczne",children:"Dzia\u0142ania asynchroniczne"}),"\n",(0,o.jsxs)(n.p,{children:["Zakomentuj poprzedni\u0105 zawarto\u015b\u0107 pliku ",(0,o.jsx)(n.code,{children:"index.ts"})]}),"\n",(0,o.jsx)(n.h4,{id:"zapis-z-callbackiem",children:"Zapis z callbackiem"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["w pliku ",(0,o.jsx)(n.code,{children:"index.ts"})," dopiszemy:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import fs from "fs"\n\nconsole.log("Start")\nfs.writeFile("nowyTest.txt",\n             "dane testowe",\n                  (err) => {\n    if (err) {\n        console.error("b\u0142\u0105d zapisu")\n        return\n    }\n    console.log("zapisano plik (async z callbackiem)")\n\n})\nconsole.log("End")\n\n/* wynik\nStart\nEnd\nzapisano plik (async z callbackiem)\n*/\n'})}),"\n",(0,o.jsxs)(n.h4,{id:"zapis-z-promisem",children:["Zapis z ",(0,o.jsx)(n.code,{children:"Promisem"})]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["w pliku ",(0,o.jsx)(n.code,{children:"index.ts"}),"  zakomentujmy porzedni kod i dopiszmy:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import {promises as fsp} from "fs"\n\nconsole.log("Start")\nasync function saveFile(){\n    try{\n        await fsp.writeFile("test3.txt", "dane testowe")\n        console.log("Plik zosta\u0142 zapisany (async/await).")\n    }catch(err){\n        console.error("b\u0142\u0105d zapisu: ", err)\n    }\n}\n\nsaveFile();\nconsole.log("End")\n\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"do\u0142\u0105czanie-danych-do-pliku---fsappendfile",children:["Do\u0142\u0105czanie danych do pliku - ",(0,o.jsx)(n.code,{children:"fs.appendFile()"})]}),"\n",(0,o.jsx)(n.h3,{id:"wersja-z-callbackiem",children:"Wersja z callbackiem"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["w pliku ",(0,o.jsx)(n.code,{children:"index.ts"})," zakomentujmy zawarto\u015b\u0107 i dopiszmy:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import fs from `fs`;\n\n\nfs.appendFile("test.txt", "\\nco\u015b nowego", (err) => {\n    if(err){\n        console.log("B\u0142\u0105d zapisu")\n    }\n    console.log("Dane dopisano do pliku")\n})\n'})}),"\n",(0,o.jsx)(n.h3,{id:"wersja-z-promisem",children:"Wersja z Promisem"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["w pliku ",(0,o.jsx)(n.code,{children:"index.ts"})," zakomentujmy zawarto\u015b\u0107 i dopiszmy:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import {promises as fsp} from `fs`;\n\nasync function addNote(note:string){\n   const now = new Date()\n    const timestamp = now. toLocaleString("pl-PL")\n    const line = `[[${timestamp}]] ${note}\\n`\n\n    try{\n        await fsp.appendFile("notes.txt", line);\n        console.log("Dopisanow do pliku (async/await): ", line.trim())\n    }catch(err){\n        console.error("B\u0142\u0105d dopisawanie: ", err)\n    }\n}\n\nconsole.log("Start")\naddNote("notatka 1")\nconsole.log("End 1")\naddNote("notatka 2")\nconsole.log("End 2")\n\n/*wynik\nStart\nEnd 1\nEnd 2\nDopisanow do pliku (async/await)\nDopisanow do pliku (async/await)\n*/\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"usuwanie-pliku---unlink",children:["Usuwanie pliku - ",(0,o.jsx)(n.code,{children:"unlink"})]}),"\n",(0,o.jsx)(n.h3,{id:"usuwanie---spos\xf3b-podstawowy",children:"Usuwanie - spos\xf3b podstawowy"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import {promises as fsp} from "fs";\n\nasync function deleteFile(filename: string){\n      try {\n        await fsp.unlink(filename);\n        console.log(`File ${filename} deleted successfully.`);\n    } catch (err: any) {\n        if (err.code === "ENOENT") {\n            console.log("File does not exist, nothing to delete.");\n        } else {\n            console.error("Error deleting file:", err);\n        }\n    }\n}\n\ndeleteFile("notes.txt")\n\n'})}),"\n",(0,o.jsx)(n.h3,{id:"usuwanie---\u0142adny-spos\xf3b",children:'Usuwanie - "\u0142adny" spos\xf3b'}),"\n",(0,o.jsx)(n.p,{children:"Poprzedni kod ma podstawowy problem z przechwytywaniem b\u0142\u0119du:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"err: any"})," ",(0,o.jsx)(n.em,{children:"de facto"})," wy\u0142\u0105cza sprawdzanie typu,"]}),"\n",(0,o.jsxs)(n.li,{children:["obiekt ",(0,o.jsx)(n.code,{children:"err"})," m\xf3g\u0142by nie mie\u0107 w\u0142a\u015bciwo\u015bci ",(0,o.jsx)(n.code,{children:"code"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import {promises as fsp} from "fs";\n\nfunction isErrnoException(e: unknown): e is NodeJS.ErrnoException {\n    return e instanceof Error && "code" in e;\n}\n\nasync function safeDeleteFile(filename: string) {\n    try {\n        await fsp.unlink(filename);\n        console.log(`File ${filename} deleted successfully.`);\n    } catch (err: unknown) {\n        if (isErrnoException(err) && err.code === "ENOENT") {\n            console.log("File does not exist, nothing to delete.");\n        } else {\n            console.error("Error deleting file:", err);\n        }\n    }\n}\n\nsafeDeleteFile("test.txt")\n\n'})}),"\n",(0,o.jsx)(n.admonition,{title:"ENOENT i inne b\u0142\u0119dy",type:"tip",children:(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Error NO ENTry \u2013 czyli \u201ebrak takiego pliku lub katalogu\u201d."}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EACCES"})," brak uprawnie\u0144,"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EEXIST"}),"  plik/katalog ju\u017c istnieje (np. przy mkdir),"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EBUSY"}),"  zas\xf3b zaj\u0119ty, nie mo\u017cna go ruszy\u0107."]}),"\n"]})}),"\n",(0,o.jsxs)(n.admonition,{title:"Type Guard",type:"note",children:[(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'function isErrnoException(e: unknown): e is NodeJS.ErrnoException {\n    return e instanceof Error && "code" in e;\n}\n'})}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"e: unknown"})," deklarujesz, \u017ce do funkcji mo\u017ce przyj\u015b\u0107 cokolwiek."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"e is NodeJS.ErrnoException"}),"  to type ",(0,o.jsx)(n.em,{children:"predicate"})," \u2013 m\xf3wi TypeScriptowi:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u201eje\u015bli ta funkcja zwr\xf3ci ",(0,o.jsx)(n.code,{children:"true"}),", to mo\u017cesz traktowa\u0107 ",(0,o.jsx)(n.code,{children:"e"})," jako ",(0,o.jsx)(n.code,{children:"NodeJS.ErrnoException"})," w tym bloku\u201d."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"instanceof Error"})," upewniasz si\u0119, \u017ce to faktycznie obiekt b\u0142\u0119du."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:'"code" in e'})," sprawdzasz, czy ma w\u0142a\u015bciwo\u015b\u0107 ",(0,o.jsx)(n.code,{children:"code"})," (kt\xf3r\u0105 maj\u0105 systemowe b\u0142\u0119dy I/O w Node.js, np. ",(0,o.jsx)(n.code,{children:"ENOENT"}),", ",(0,o.jsx)(n.code,{children:"EACCES"}),")."]}),"\n"]})]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"foldery",children:"Foldery"}),"\n",(0,o.jsx)(n.h3,{id:"tworzenie-folderu",children:"Tworzenie folderu"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import {promises as fsp} from "fs"\n\nconst createFolder = async () => {\n    try{\n        await fsp.mkdir("data")\n        console.log("Katalog \'data\' utworzony")\n    }catch (err){\n        if(isErrnoException(err) && err.code === "EEXIST"){\n            console.log("Katalog ju\u017c istnieje")\n        }else {\n            console.log(`Error: ${err}`)\n        }\n    }\n}\n\n\nfunction isErrnoException(err: unknown): err is NodeJS.ErrnoException {\n    return err instanceof Error && "code" in err;\n}\n\n\ncreateFolder();\n\n\n\n'})}),"\n",(0,o.jsx)(n.admonition,{title:"Natychmiastowe tworzenie podkatalog\xf3w:",type:"tip",children:(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["zamiast ",(0,o.jsx)(n.code,{children:'await fsp.mkdir("data")'})]}),"\n",(0,o.jsxs)(n.li,{children:["wpisz ",(0,o.jsx)(n.code,{children:'await fsp.mkdir("data/subdir/nested", { recursive: true });'})]}),"\n"]})}),"\n",(0,o.jsx)(n.h3,{id:"usuwanie-folderu",children:"Usuwanie folderu"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'await fsp.rm("data", { recursive: true, force: true });\nconsole.log("Katalog \'data\' usuni\u0119ty");\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"recursive: true"})," rekursywnie usuwa ca\u0142\u0105 zawarto\u015b\u0107 (podkatalogi te\u017c),"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"force: true"})," nie rzuca b\u0142\u0119du, je\u015bli folder nie istnieje."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"listowanie-plik\xf3\u0153-z-folderu",children:"Listowanie plik\xf3\u0153 z folderu"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'const files = await fsp.readdir(".");\nconsole.log("Pliki i katalogi w bie\u017c\u0105cym folderze:", files);\n\n\n'})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>d});var s=i(6540);const o={},l=s.createContext(o);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);