"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[9080],{8025:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"ExpressJS/Express/RetroGamesDB/Routes","title":"Routes","description":"Na razie wszystkie trasy mieli\u015bmi zdefiniowane w jednym pliku app.ts.","source":"@site/docs/3. ExpressJS/50.Express/20.RetroGamesDB/90.Routes.mdx","sourceDirName":"3. ExpressJS/50.Express/20.RetroGamesDB","slug":"/ExpressJS/Express/RetroGamesDB/Routes","permalink":"/web/docs/ExpressJS/Express/RetroGamesDB/Routes","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/3. ExpressJS/50.Express/20.RetroGamesDB/90.Routes.mdx","tags":[],"version":"current","sidebarPosition":90,"frontMatter":{"title":"Routes"},"sidebar":"tutorialSidebar","previous":{"title":"Metoda `DELETE`","permalink":"/web/docs/ExpressJS/Express/RetroGamesDB/MetodaDELETE"},"next":{"title":"CRUD z JSON","permalink":"/web/docs/ExpressJS/Express/RetroGamesDB/DaneWJSON"}}');var o=n(4848),t=n(8453);const i={title:"Routes"},a=void 0,d={},c=[{value:"Definicja tras w pliku <code>routes/games.ts</code>",id:"definicja-tras-w-pliku-routesgamests",level:3},{value:"U\u017cycie <code>router</code> w g\u0142\xf3wnym pliku <code>app.ts</code>",id:"u\u017cycie-router-w-g\u0142\xf3wnym-pliku-appts",level:3}];function l(e){const s={admonition:"admonition",code:"code",em:"em",h3:"h3",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.p,{children:["Na razie wszystkie trasy mieli\u015bmi zdefiniowane w jednym pliku ",(0,o.jsx)(s.code,{children:"app.ts"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["Taki podej\u015bcie jest wbrew zasadzie ",(0,o.jsx)(s.em,{children:"separation of concerns"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["Wszystkie \u015bcie\u017cki przeniesiemy do pliku ",(0,o.jsx)(s.code,{children:"routes.ts"}),", kt\xf3ry b\u0119dzie odpowiada\u0142 wy\u0142\u0105cznie za trasy."]}),"\n",(0,o.jsxs)(s.admonition,{type:"note",children:[(0,o.jsxs)(s.mdxAdmonitionTitle,{children:["Co to jest ",(0,o.jsx)(s.code,{children:"Router"})]}),(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"Router"})," w Expressie to miniwersja aplikacji Express,\nczyli \u201emini serwer w serwerze\u201d."]}),"\n",(0,o.jsxs)(s.li,{children:["Mo\u017cna w nim definiowa\u0107 w\u0142asne \u015bcie\u017cki (",(0,o.jsx)(s.code,{children:"GET"}),", ",(0,o.jsx)(s.code,{children:"POST"}),", ",(0,o.jsx)(s.code,{children:"DELETE"})," itd.)\ndok\u0142adnie tak samo, jak w ",(0,o.jsx)(s.code,{children:"app"}),", ale w mniejszej, wydzielonej cz\u0119\u015bci."]}),"\n"]})]}),"\n",(0,o.jsxs)(s.admonition,{type:"tip",children:[(0,o.jsxs)(s.mdxAdmonitionTitle,{children:["\ufe0f ",(0,o.jsx)(s.code,{children:"app.ts"})," jako budynek, a ",(0,o.jsx)(s.code,{children:"router"})," jako dzia\u0142"]}),(0,o.jsxs)(s.p,{children:["W du\u017cej aplikacji Express wszystkie \u015bcie\u017cki w jednym pliku staj\u0105 si\u0119 trudne do utrzymania.\nDlatego wprowadzamy ",(0,o.jsx)(s.strong,{children:"routery"})," \u2014 osobne modu\u0142y z w\u0142asnymi \u015bcie\u017ckami."]}),(0,o.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,o.jsx)(s.strong,{children:"Metafora:"})]}),(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"app.ts"})," to ",(0,o.jsx)(s.strong,{children:"g\u0142\xf3wne wej\u015bcie do budynku"})," (ca\u0142ego serwera),"]}),"\n",(0,o.jsxs)(s.li,{children:["a ka\u017cdy plik w folderze ",(0,o.jsx)(s.code,{children:"routes/"})," to ",(0,o.jsx)(s.strong,{children:"osobny dzia\u0142 w tym budynku"}),"\n(np. dzia\u0142 gier, dzia\u0142 u\u017cytkownik\xf3w, dzia\u0142 wynik\xf3w)."]}),"\n"]})]}),"\n",(0,o.jsxs)(s.h3,{id:"definicja-tras-w-pliku-routesgamests",children:["Definicja tras w pliku ",(0,o.jsx)(s.code,{children:"routes/games.ts"})]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["z ",(0,o.jsx)(s.code,{children:"app.ts"})," wycinamy wszystkie trasy z endpontem ",(0,o.jsx)(s.code,{children:"/games"})]}),"\n",(0,o.jsxs)(s.li,{children:["przenosimy je do pliku ",(0,o.jsx)(s.code,{children:"routes/games.ts"})]}),"\n",(0,o.jsxs)(s.li,{children:["w tym nowym pliku nie mam serwera Express, wi\u0119c ",(0,o.jsx)(s.code,{children:"app"})," trzeba zast\u0105pi\u0107 przez ",(0,o.jsx)(s.code,{children:"Router()"})]}),"\n",(0,o.jsx)(s.li,{children:"oczywi\u015bcie niezb\u0119dne s\u0105 wszystkie importy"}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.code,{children:"games.ts"})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-ts",children:'import express, {Request, Response} from "express";\n\nimport {games} from "../data/gamesData";\nimport {Game} from "../models/game";\n\nconst router = express.Router();\n\n\n\nrouter.get("/", (req: Request, res: Response) => {\n    console.log(req.query)\n    const {year, platform} = req.query;\n    const filteredGames = games.filter(g => {\n        if (year) return g.year < Number(year);\n        if (platform) return g.platform === platform;\n        return true;\n    });\n\n    res.json(filteredGames);\n})\n\nrouter.get("/:id", (req: Request, res: Response) => {\n    const game = games.find(g => g.id === Number(req.params.id));\n    if (!game) return res.status(404).json({ message: "Game not found" });\n    res.json(game);\n});\n\n\n\nrouter.post("/", (req: Request, res: Response) => {\n    console.log(req.body) // w konsoli podgl\u0105damy warto\u015b\u0107 po dzia\u0142\u0105niu express.json()\n    try{\n        const {title, year, platform, genre} = req.body;\n\n\n        if (!title || !year || !platform || !genre) {\n            return res.status(400).json({message: "Missing required fields"});\n        }\n\n        const newGame: Game = {\n            id: Date.now(),\n            title,\n            year,\n            platform,\n            genre,\n        };\n\n        games.push(newGame); // dodajemy do naszej listy jakby bazy danych\n        res.status(201).json(newGame); // zwracamy nowy obiekt z kodem 201\n    }catch(error){\n        if(error instanceof Error){\n            res.status(500).json({message: error.message});\n        }else{\n            console.error(error);\n        }\n\n    }\n\n})\n\nrouter.put("/:id", (req, res) => {\n    try {\n        const id = Number(req.params.id); // parsowanie id: string -> id: int\n        const index = games.findIndex(g => g.id === id); // zwraca index albo -1\n        if (index === -1) return res.status(404).send("Game not found");\n\n        games[index] = { id, ...req.body }; // nadpisujemy obiekt gry pozostawiamy id bez zmian\n        res.json(games[index]);\n    } catch (error) {\n        console.error("Error updating the game", error); // Log do konsoli\n        res.status(500).json({ message: "Internal server error" }); // Odpowied\u017a dla klienta\n    }\n});\n\nrouter.patch("/:id", (req, res) => {\n    try{\n        const id = Number(req.params.id);\n        const game = games.find(g => g.id === id);\n        if (!game) return res.status(404).send("Game not found");\n\n        Object.assign(game, req.body); // aktualizacja tylko podanych p\xf3l\n        res.json(game);\n    }catch(error){\n        console.error(error)\n    }\n});\n\n\nrouter.delete("/:id", (req: Request, res: Response) => {\n    try {\n        const id = Number(req.params.id);\n\n        // Walidacja ID\n        if (isNaN(id) || id <= 0) {\n            return res.status(400).json({ message: "Invalid ID value \u2014 please provide a positive integer." });\n        }\n\n        const index = games.findIndex(g => g.id === id);\n        if (index === -1) {\n            return res.status(404).json({ message: "Game not found" });\n        }\n\n        // Usu\u0144 gr\u0119\n        const deletedGame = games.splice(index, 1)[0];\n\n\n        res.json({\n            message: "Game deleted successfully!",\n            deleted: deletedGame\n        });\n    } catch (error) {\n        console.error("Error deleting the game: ", error);\n        res.status(500).json({ message: "Internal server error" });\n    }\n});\n\n\nexport default router;\n'})}),"\n",(0,o.jsxs)(s.h3,{id:"u\u017cycie-router-w-g\u0142\xf3wnym-pliku-appts",children:["U\u017cycie ",(0,o.jsx)(s.code,{children:"router"})," w g\u0142\xf3wnym pliku ",(0,o.jsx)(s.code,{children:"app.ts"})]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-ts",children:'import express, {Request, Response} from \'express\';\nimport {games} from "./data/gamesData";\nimport {Game} from "./models/game";\nimport gamesRouter from "./routes/games";\nimport router from "./routes/games";\n\nconst app = express();\n\napp.use(express.json());\napp.use("/games", gamesRouter) // router jako middleware\n//....\n\n'})})]})}function m(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>a});var r=n(6540);const o={},t=r.createContext(o);function i(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);